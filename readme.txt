一、更新操作流程(完整备份)：

1. 复制现有的除开更新包中的所有文件到更新目录@EaseSvrSwitcher
2. 尝试关闭服务，如在一定时间内超时（如5秒）中强制终止进程退出
*******************
3. 重命名现有服务目录为备份目录：如bak-20101228173512
4. 重命名更新目录@EaseSvrSwitcher为旧服务目录
5. 重新启动服务
*******************
步骤3-5为间断服务时间，主要时间消耗在重命名目录及启动服务上。


二、还原操作流程(完整包)：
1. 尝试关闭服务，如在一定时间内超时（如5秒）中强制终止进程退出
*******************
2. 重命名现有服务目录为备份目录：如bak-20101228173512
3. 重命名备份目录(如：bak-20101225173512)为旧服务目录
4. 重新启动服务
*******************
步骤2-4为间断服务时间，主要时间消耗在重命名目录及启动服务上。



三、更新操作流程(选择备份)：

1. 复制现有的更新包中的所有同名文件到备份目录，如pbak-20101228173512
2. 如果更新包为zip包则解压到更新临时目录，如@update~
3. 尝试关闭服务，如在一定时间内超时（如5秒）中强制终止进程退出
*******************
4. 覆盖所有更新包内同名文件
5. 重新启动服务
*******************
步骤4-5为间断服务时间，主要时间消耗在覆盖(合并)目录及启动服务上。



四、还原操作流程(选择备份包)，类似与选择更新，只不过更新文件为旧文件。


#更新服务CLRSvrHost，忽略目录名为Logs的文件拷贝，更新包来自目录
EaseSvrSwitcher -full -s CLRSvrHost -i "Logs" -d "D:\DevRoot\Remote\release\easesvr123\update2010-1228"

#更新服务CLRSvrHost，忽略目录名为Logs的文件拷贝，更新包来自zip文件
EaseSvrSwitcher -full -s CLRSvrHost -i "Logs" -pkg "D:\DevRoot\Remote\release\easesvr123\update2010-1228.zip"


*建立切换任务标志， 统计间断服务时间，单位毫秒，完成后写入切换标识文件内容。